<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<link rel="manifest" href="manifest.json">
<title>Code Viewer</title>

<style>
/* ================= BASE ================= */

html, body {
  margin: 0;
  height: 100%;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
  overscroll-behavior: none;
}

body {
  display: flex;
  flex-direction: row;
                /* защита от выделения и системных меню */
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
}

/* ================= EDITOR ================= */

#editorContainer {
  display: flex;
  flex: 0 0 40%;
  min-width: 0;
}

#lineNumbering {
  width: 44px;
  padding: 10px 6px;
  font-family: monospace;
  font-size: 14px;
  line-height: 1.2;
  color: #666;
  background: #111;
  text-align: right;
  white-space: pre;
  user-select: none;
}

#editor {
  flex: 1;
  padding: 10px;
  background: black;
  color: white;
  border: none;
  outline: none;
  resize: none;
  font-family: monospace;
  font-size: 14px;
  line-height: 1.2;
  white-space: pre;
  overflow: auto;
}

/* ================= RESIZER ================= */

#resizer {
  width: 8px;
  background: #111;
  cursor: col-resize;
  flex-shrink: 0;
  position: relative;
}

/* метка-хваталка */
#resizer::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 3px;
  height: 40px;
  background: #555;
  transform: translate(-50%, -50%);
  border-radius: 2px;
}

#resizer:hover {
  background: #222;
}

/* ================= PREVIEW ================= */

#preview {
  flex: 1;
  border: none;
  background: #333;
  min-width: 0;
}

/* ================= CONTROL PANEL ================= */

#controlPanel {
  width: 120px;
  min-width: 100px;
  background: black;
  border-left: 1px solid #222;
  display: flex;
  flex-direction: column;
  gap: 12px;
  padding: 8px;
}

.control-row {
  display: flex;
  gap: 6px;
  align-items: center;
}

/* элементы */
input {
  width: 100%;
  padding: 6px;
  background: #333;
  color: white;
  border: 1px solid #555;
  border-radius: 5px;
}

button {
  height: 36px;
  background: #333;
  color: white;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 16px;
}

button:hover {
  background: #555;
}

.arrow-row button {
  flex: 1;
}

select {
  width: 70%;
  height: 34px;
  background: #222;
  color: white;
  border: 1px solid #555;
}

#saveButton {
  background: #007bff;
}

#saveButton:hover {
  background: #0056b3;
}

.logo {

align-items: center;

  justify-content: left;
}

.logo img {


  height: 40px;
  opacity: 0.5;
}

/* ================= PORTRAIT ================= */

@media (orientation: portrait) {

  body {
    flex-direction: column;
  }

  #editorContainer {
    flex: 0 0 42%;
  }

  #resizer {
    width: 100%;
    height: 8px;
    cursor: row-resize;
  }

  #resizer::before {
    width: 40px;
    height: 3px;
  }

  #controlPanel {
    width: 100%;
    min-width: 0;
    flex-direction: row;
    flex-wrap: wrap;
    gap: 6px;
  }

  .control-row {
    width: auto;
    white-space: nowrap;
  }

  input {
    width: 14ch;
  }

  select,
  #saveButton {
    width: auto;
    min-width: 70px;
  }

  .logo img {
    height: 40px;
  }
}
</style>
</head>

<body>

<!-- EDITOR -->
<div id="editorContainer">
  <div id="lineNumbering">1</div>
  <textarea id="editor" placeholder="Type code..."></textarea>
</div>

<!-- RESIZER -->
<div id="resizer"></div>

<!-- PREVIEW -->
<iframe id="preview"></iframe>

<!-- CONTROL PANEL -->
<div id="controlPanel">

  <div class="control-row">
    <input id="searchField" placeholder="Search">
  </div>

  <div class="control-row arrow-row">
    <button id="prevMatch">▲</button>
    <button id="nextMatch">▼</button>
  </div>

  <div class="control-row">
    <select id="fileFormat">
      <option>HTML</option>
      <option>JSON</option>
      <option>TXT</option>
      <option>JS</option>
      <option>CSS</option>
    </select>
  </div>

  <div class="control-row">
    <button id="saveButton">Save</button>
  </div>

  <div class="control-row logo">
    <a href="index.html">
      <img src="logo.png" alt="logo">
    </a>
  </div>

</div>

<script>
/* ================= EDITOR ================= */

const editor = document.getElementById('editor');
const preview = document.getElementById('preview');
const lineNumbering = document.getElementById('lineNumbering');

function updateLines() {
  const count = editor.value.split('\n').length;
  lineNumbering.textContent =
    Array.from({length: count}, (_, i) => i + 1).join('\n');
}

editor.addEventListener('input', () => {
  preview.srcdoc = editor.value;
  updateLines();
});

editor.addEventListener('scroll', () => {
  lineNumbering.scrollTop = editor.scrollTop;
});

updateLines();

/* ================= RESIZER LOGIC ================= */

const resizer = document.getElementById('resizer');
const editorContainer = document.getElementById('editorContainer');

let dragging = false;

resizer.addEventListener('mousedown', () => dragging = true);
window.addEventListener('mouseup', () => dragging = false);

window.addEventListener('mousemove', e => {
  if (!dragging) return;

  if (window.matchMedia('(orientation: portrait)').matches) {
    const percent = e.clientY / window.innerHeight * 100;
    editorContainer.style.flex = `0 0 ${percent}%`;
  } else {
    const percent = e.clientX / window.innerWidth * 100;
    editorContainer.style.flex = `0 0 ${percent}%`;
  }
});
</script>

</body>
</html>