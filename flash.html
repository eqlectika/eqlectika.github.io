<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <link rel="manifest" href="manifest.json">
  <title>Fast Reading Converter</title>
  <style>
    html, body {
      overscroll-behavior: none; min-height: 100dvh; margin: 0; padding: 0;
      background-color: #000000; color: #fff; font-family: Arial, sans-serif;
      overflow-y: auto;
      -webkit-user-select: none; user-select: none;
    }

    #container {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      display: flex; justify-content: center; align-items: center;
      z-index: 10;
      perspective: 1000px;
      pointer-events: none;
    }

    .footer-block { 
      z-index: 100; width: 100%;
      display: flex; flex-direction: column; align-items: center; 
      position: relative;
      padding-top: 100px;
      padding-bottom: calc(env(safe-area-inset-bottom, 5px) + 20px);
    }

    #inputContainer { 
      position: relative; flex-shrink: 0; padding: 0px 5px 0px; 
      z-index: 100; width: 100%; display: flex; flex-direction: column; 
      align-items: center; box-sizing: border-box; transition: opacity 0.6s ease;
    }

    #clickShield {
      position: fixed; top: 0; left: 0; width: 100%; height: calc(100% - 130px);
      z-index: 150; display: none; cursor: pointer;
    }

    body.is-reading #clickShield { display: block; }

    .footer-block > *, #mainButtons > button, #accelBtn { pointer-events: auto; }

    #mainButtons { display: flex; flex-direction: column; align-items: center; gap: 5px; }
    .button-row { display: flex; align-items: center; gap: 5px; }

    .word-layer {
      position: fixed; top: 50%; left: 50%; 
      transform: translate(-50%, -50%);
      text-align: center; font-weight: 700; white-space: nowrap;
      width: 90%; z-index: 60; pointer-events: none;
    }

    .word-enter { 
      opacity: 0; 
      transform: translate(-50%, -50%) translateZ(500px); 
      filter: blur(12px); 
    }

    .word-active { 
      opacity: 1; 
      transform: translate(-50%, -50%); 
      transition: all 0.1s cubic-bezier(0.23, 1, 0.32, 1);
      filter: blur(0); 
    }

    .word-exit { 
      opacity: 0; 
      transform: translate(-50%, calc(-50% - 40px)) scale(0);
      filter: blur(10px); 
      transition: transform 0.6s ease-in, opacity 0.6s linear, filter 0.4s 0.2s ease-in;
    }

    .word-exit-long { 
      opacity: 0; 
      transform: translate(-50%, calc(-50% - 40px)) scale(1);
      filter: blur(20px); 
      transition: transform 1.5s cubic-bezier(0.1, 0.8, 0.2, 1), opacity 1.5s linear, filter 0.7s 0.8s ease-in;
    }

    body.is-reading .footer-block { 
      position: fixed; 
      bottom: 0; 
      height: auto; 
      min-height: 120px; 
      display: flex; 
      flex-direction: column; 
      justify-content: flex-end;
      z-index: 200; 
      pointer-events: none;
      padding-bottom: calc(env(safe-area-inset-bottom, 5px) + 15px);
    }

    body.is-reading #inputContainer, body.is-reading #logoContainer { opacity: 0 !important; pointer-events: none; }

    button {
      font-size: 14px; background: transparent; color: white;
      border-radius: 14px; border: 1px solid rgba(255,255,255,0.3); 
      padding: 10px 20px; cursor: pointer; touch-action: manipulation;
      position: relative; z-index: 110;
    }

    #settingsContainer {
      display: flex; flex-direction: column; align-items: center; gap: 10px; margin: 20px 0; z-index: 110; transition: opacity 0.6s ease;
    }

    .setting-btn {
      display: inline-flex; align-items: center; justify-content: center;
      width: auto; min-width: 150px; border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 30px; padding: 12px 20px; font-size: 12px;
      cursor: pointer; color: rgba(255, 255, 255, 0.4); background: transparent;
    }

    body.is-reading #settingsContainer { opacity: 0; pointer-events: none; }

    #backBtn { 
      display: none; 
      margin-bottom: 15px;
      background: rgba(255,255,255,0.1); 
      z-index: 210;
    }

    body.is-paused #backBtn { display: block; }
    #startBtn { background: #fff; color: #000; font-weight: bold; border: none; min-width: 100px; }
    body.is-reading #startBtn, body.is-reading #slowerBtn, body.is-reading #fasterBtn { 
      opacity: 0.38; background: transparent; color: #fff; border: 1px solid rgba(255,255,255,0.2); 
    }
    body.is-paused #slowerBtn, body.is-paused #fasterBtn { display: none; }
    body.is-paused #startBtn { background: #fff; color: #000; opacity: 1; }

    #accelBtn {
      display: none; margin-top: 10px; border-radius: 20px; 
      color: rgba(255,255,255,0.5); font-size: 11px;
    }
    body.is-paused #accelBtn { display: inline-flex; }

    #inputText {
      -webkit-user-select: text !important;
      user-select: text !important;
      pointer-events: auto !important;
      width: 90%; max-width: 650px; min-height: 190px;
      padding: 10px 14px; background: rgba(255,255,255,0.05); 
      color: #fff; border: 1px solid rgba(255,255,255,0.2); 
      border-radius: 0px; font-size: 16px; outline: none; 
      box-sizing: border-box; resize: none; display: block;
      font-family: Arial, sans-serif;
    }

    .donate-box { 
      display: flex; flex-direction: column; gap: 10px; 
      margin-top: 30px; width: 100%; align-items: center;
      transition: opacity 0.6s ease;
    }
    body.is-reading .donate-box { opacity: 0 !important; pointer-events: none; }

    .donate-btn { 
      color: rgba(255,255,255,0.7); border: 1px solid rgba(255,255,255,0.7); 
      padding: 5px 15px; background: transparent; cursor: pointer; 
      font-size: 11px; border-radius: 12px;
    }
    .donate-btn:hover { background: #fff; color: #000; }

    .crypto-info { 
      display: none; flex-direction: column; gap: 5px; 
      margin-top: 10px; align-items: center; 
    }
    .crypto-address-display { 
      font-size: 10px; color: #fff; background: rgba(255,255,255,0.1); 
      padding: 8px 12px; border: 1px dashed #fff; cursor: copy; 
      word-break: break-all; max-width: 360px;
    }
  </style>
</head>
<body>
  <script src="pwa-init.js"></script>
  <div id="logoContainer" style="position: absolute; top: 20px; left: 50%; transform: translateX(-50%); z-index: 120;">
    <a href="index.html" style="text-decoration: none;">
      <img src="logo.png" alt="Logo" style="max-width: 56px; opacity: 0.7;">
    </a>
  </div>

  <div id="container"></div>
  <div id="clickShield"></div>

  <div class="footer-block">
    <div id="inputContainer">
      <textarea id="inputText" placeholder="Paste your text here..."></textarea>
    </div>

    <div id="settingsContainer">
        <div id="colorControl" class="setting-btn">Background Color</div>
        <div id="textColorControl" class="setting-btn">Text Color</div>
    </div>

    <button id="backBtn">← One Word Back</button>
    <div id="mainButtons">
      <div class="button-row">
        <button id="slowerBtn">Slower</button>
        <button id="startBtn">Start</button>
        <button id="fasterBtn">Faster</button>
      </div>
      <button id="accelBtn" class="setting-btn">Dynamic Accel: OFF</button>
    </div>

    <div class="donate-box">
      <button class="donate-btn" onclick="toggleDonate()">Support</button>
      <div id="cryptoInfo" class="crypto-info">
        <span style="font-size: 12px; color: #fff; margin-bottom: 4px;">USDT BSC (BEP20)</span>
        <div id="cryptoAddr" class="crypto-address-display" onclick="copyToClipboard()">0x769192cea8fbb7207f086d95fd653ebc3adb0c72</div>
        <span id="copyHint" style="font-size: 12px; color: #fff; margin-top: 4px;">Click address to copy</span>
      </div>
    </div> 
  </div>

<script>
    const container = document.getElementById('container');
    const inputText = document.getElementById('inputText');
    const startBtn = document.getElementById('startBtn');
    const backBtn = document.getElementById('backBtn');
    const fasterBtn = document.getElementById('fasterBtn');
    const slowerBtn = document.getElementById('slowerBtn');
    const colorControl = document.getElementById('colorControl');
    const textColorControl = document.getElementById('textColorControl');
    const clickShield = document.getElementById('clickShield');
    const accelBtn = document.getElementById('accelBtn');

    const colors = ['#000000', '#2a0505', '#05052a', '#052a05', '#1a1a1a'];
    const textColors = ['#ffffff', '#ffeb3b', '#00ff00', '#ff4444', '#80cbc4', '#ffa726'];
    
    let colorIndex = parseInt(localStorage.getItem('reading_colorIndex')) || 0;
    let textColorIndex = parseInt(localStorage.getItem('reading_textColorIndex')) || 0;
    let words = [], index = 0, timer = null, isPaused = false, isReading = false;
    let interval = parseInt(localStorage.getItem('reading_interval')) || 600;
    let isDynamicAccel = false;

    document.body.style.backgroundColor = colors[colorIndex];
    inputText.value = localStorage.getItem('reading_text') || "";

    function updateFontSize(text, el) {
        const maxWidth = window.innerWidth * 0.9;
        const standardSize = 36;
        el.style.fontSize = standardSize + 'px';
        let currentWidth = text.length * (standardSize * 0.6); 
        if (currentWidth > maxWidth) {
            const reducedSize = (maxWidth / text.length) / 0.6;
            el.style.fontSize = reducedSize + 'px';
        }
    }

    function clearOldWord(isLongExit = false) {
        const oldEl = container.querySelector('.word-active');
        if (oldEl) {
            const exitClass = isLongExit ? 'word-exit-long' : 'word-exit';
            oldEl.classList.replace('word-active', exitClass);
            setTimeout(() => oldEl.remove(), isLongExit ? 1500 : 600);
        }
    }

    function showNext() {
        if (index >= words.length || isPaused || !isReading) {
            if (index >= words.length) stopReading();
            return;
        }

        let rawTxt = words[index];
        let displayTxt = rawTxt;
        let isLongHold = displayTxt.includes('/');
        if (isLongHold) displayTxt = displayTxt.replace(/\//g, '');

        clearOldWord(isLongHold);

        const isPunctuationOnly = /^[.,!?;:]+$/.test(displayTxt);

        if (displayTxt !== " " && !displayTxt.includes('|')) {
            if (!isPunctuationOnly || (isPunctuationOnly && isLongHold)) {
                const newEl = document.createElement('div');
                newEl.className = 'word-layer word-enter';
                newEl.textContent = displayTxt;
                newEl.style.color = textColors[textColorIndex];
                updateFontSize(displayTxt, newEl);
                container.appendChild(newEl);
                requestAnimationFrame(() => setTimeout(() => newEl.classList.replace('word-enter', 'word-active'), 20));
            }
        }

        let pauses = 1; 
        if (displayTxt.includes('|')) pauses = 5; 
        else if (rawTxt === " ") pauses = 3; 
        else {
            if (displayTxt.replace(/[.,!?;:]/g, '').length <= 3) pauses = 1.5;
            if (/[;,-]/.test(displayTxt)) pauses = 2.5; 
            if (/[.:!?—]/.test(displayTxt)) pauses = 4;
            if (isLongHold) pauses += 2;
        }


        let currentInterval = interval;
if (isDynamicAccel && words.length > 1) {
    let progress = index / (words.length - 1);
    const phi = 0.618; 
    let factor = progress <= phi 
        ? (1 - (progress / phi) * 0.5) 
        : (0.5 + ((progress - phi) / (0.382)) * 0.5);
    currentInterval = interval * factor;
}

  
        index++;
        timer = setTimeout(showNext, currentInterval * pauses);
    }

    function stopReading() {
        clearTimeout(timer);
        isReading = false; isPaused = false;
        document.body.classList.remove('is-reading', 'is-paused');
        startBtn.textContent = 'Start';
        container.innerHTML = '';
    }

    accelBtn.onclick = (e) => {
        e.stopPropagation();
        isDynamicAccel = !isDynamicAccel;
        accelBtn.textContent = `Dynamic Accel: ${isDynamicAccel ? 'ON' : 'OFF'}`;
        accelBtn.style.color = isDynamicAccel ? '#fff' : 'rgba(255, 255, 255, 0.4)';
    };

    startBtn.onclick = (e) => {
        e.stopPropagation();
        if (!isReading) {
            const text = inputText.value.trim();
            if (!text) return;
            localStorage.setItem('reading_text', text);
            words = text.split(/(\s{2,})|\s+/).filter(w => w !== undefined && w !== "").map(w => w.trim() === "" ? " " : w.replace(/_/g, ' '));
            index = 0; isReading = true; isPaused = false;
            document.body.classList.add('is-reading');
            startBtn.textContent = 'Pause';
            showNext();
        } else {
            isPaused = !isPaused;
            document.body.classList.toggle('is-paused', isPaused);
            startBtn.textContent = isPaused ? 'Continue' : 'Pause';
            if (!isPaused) showNext(); else clearTimeout(timer);
        }
    };

    backBtn.onclick = (e) => {
        e.stopPropagation();
        index = Math.max(0, index - 2);
        clearOldWord();
        if (isPaused) {
            const wasPaused = isPaused; isPaused = false;
            showNext(); clearTimeout(timer); isPaused = wasPaused;
        }
    };

    fasterBtn.onclick = (e) => { e.stopPropagation(); interval = Math.max(50, interval - 50); localStorage.setItem('reading_interval', interval); };
    slowerBtn.onclick = (e) => { e.stopPropagation(); interval += 50; localStorage.setItem('reading_interval', interval); };
    colorControl.onclick = (e) => { e.stopPropagation(); colorIndex = (colorIndex + 1) % colors.length; document.body.style.backgroundColor = colors[colorIndex]; localStorage.setItem('reading_colorIndex', colorIndex); };
    textColorControl.onclick = (e) => { e.stopPropagation(); textColorIndex = (textColorIndex + 1) % textColors.length; localStorage.setItem('reading_textColorIndex', textColorIndex); textColorControl.style.color = textColors[textColorIndex]; setTimeout(() => { textColorControl.style.color = 'rgba(255, 255, 255, 0.4)'; }, 300); };
    clickShield.onclick = stopReading;

    function toggleDonate() { const info = document.getElementById("cryptoInfo"); info.style.display = (info.style.display === "flex") ? "none" : "flex"; info.scrollIntoView({ behavior: 'smooth' }); }
    function copyToClipboard() { const addr = document.getElementById("cryptoAddr"); const hint = document.getElementById("copyHint"); const text = addr.innerText; navigator.clipboard.writeText(text).then(() => { addr.innerText = "Copied!"; addr.style.color = "#00ff00"; setTimeout(() => { addr.innerText = text; addr.style.color = "#fff"; }, 1500); }); }
    document.getElementById('inputText').addEventListener('touchmove', (e) => { const rect = e.target.getBoundingClientRect(); const touchY = e.touches[0].clientY; if (touchY > rect.top + 30 && touchY < rect.bottom - 30) e.stopPropagation(); }, { passive: false });
</script> 
</body>
</html>
